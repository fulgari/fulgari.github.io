<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="referrer" content="no-referrer"/><meta name="next-head-count" content="3"/><link rel="preload" href="https://fulgari.github.io/_next/static/css/a0f53b99e1117ef0.css" as="style"/><link rel="stylesheet" href="https://fulgari.github.io/_next/static/css/a0f53b99e1117ef0.css" data-n-g=""/><link rel="preload" href="https://fulgari.github.io/_next/static/css/c2a527101433f11d.css" as="style"/><link rel="stylesheet" href="https://fulgari.github.io/_next/static/css/c2a527101433f11d.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://fulgari.github.io/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="https://fulgari.github.io/_next/static/chunks/webpack-d59445d4db0d9d34.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/framework-cdb3b77137bd004f.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/main-177456dd4f77fcee.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/pages/_app-76d5ff31e5e3402a.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/6-82bf2f3c231febcd.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/448-efa4045d3d969541.js" defer=""></script><script src="https://fulgari.github.io/_next/static/chunks/pages/blog/%5Bslug%5D-f2fc04399951d5f2.js" defer=""></script><script src="https://fulgari.github.io/_next/static/yhe8F9jpnbaXFIeVB9bEE/_buildManifest.js" defer=""></script><script src="https://fulgari.github.io/_next/static/yhe8F9jpnbaXFIeVB9bEE/_ssgManifest.js" defer=""></script><script src="https://fulgari.github.io/_next/static/yhe8F9jpnbaXFIeVB9bEE/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="container mx-auto px-[5vw] max-w-screen-xl"><div class="mb-32"><header class="flex justify-between items-center my-10 h-52 bg-no-repeat bg-center"><div class="logo ml-8 flex justify-start items-center cursor-pointer transition-transform hover:scale-125 hover:skew-y-12 hover:-rotate-12"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27128%27%20height=%27128%27/%3e"/></span><img alt="Fulgari" href="/" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Fulgari" href="/" srcSet="https://fulgari.github.io/fulgari.png 1x, https://fulgari.github.io/fulgari.png 2x" src="https://fulgari.github.io/fulgari.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><ul class="list-none float-right mr-8"><span class="navbar-item mx-8 cursor-pointer text-gray-400 hover:text-black uppercase font-light" href="/">Home</span><span class="navbar-item mx-8 cursor-pointer text-gray-400 hover:text-black uppercase font-light" href="/about">About</span><span class="navbar-item mx-8 cursor-pointer text-gray-400 hover:text-black uppercase font-light" href="/contact">Contact</span></ul></header><title>技术优化小记（Web Vitals、兼容性等）<!-- --> | J.P.</title><h1 class="text-3xl flex justify-center items-center underline" style="text-decoration-color:#9714da;margin-bottom:2em">技术优化小记（Web Vitals、兼容性等）</h1><div class="blog-post-container"><h1>技术优化</h1>
<p>主要分为UX、DX两个方面，优化用户体验和开发体验。</p>
<h2>保持输入</h2>
<p>保持对前端技术的灵敏嗅觉，了解新技术趋势（如swc、fresh、astro、qwik、million、lexical、turbopack、esbuild等新技术），并结合实际场景进行落地。</p>
<h2>优化Web Vitals</h2>
<ul>
<li>提升FCP（<em>优&#x3C;1.8s&#x3C;差强人意&#x3C;3s&#x3C;差</em>）：
<ul>
<li>动态加载组件</li>
<li>lazy-load/CDN img</li>
<li>h2/h3</li>
<li>用webpack删代码treeShake+分包splitChunks</li>
<li>并行请求</li>
<li>文本内容尽早展示（font-display: swap）</li>
<li>善用缓存（cache-control/expires/etag/last-modified）</li>
<li>brotli格式压缩（nginx 配置）</li>
<li>Inline CSS</li>
<li>Inline Img（base64）</li>
<li>CDN加载公共js</li>
</ul>
</li>
<li>提升CLS（<em>impact×distance，优&#x3C;0.1&#x3C;差强人意&#x3C;0.25&#x3C;差</em>）：
<ul>
<li>善用亲属关系hint（rel=dns-prefetch/prefetch/preload/preconnect）</li>
<li>WebP格式</li>
</ul>
</li>
<li>提升FID（<em>优&#x3C;100ms&#x3C;差强人意&#x3C;200ms&#x3C;差</em>）：
<ul>
<li>将大的同步操作拆分为小的异步操作</li>
<li>使用SSR</li>
<li>对耗时请求设置支持中断和超时</li>
<li>复杂计算使用 Web Worker</li>
</ul>
</li>
</ul>
<h2>优化兼容性</h2>
<ul>
<li>成体系的CSS兼容方案
<ul>
<li>使用css预处理器/后处理器：前者提高代码编写的便捷性，后者可以用autoprefixer完善前缀等</li>
<li>animation动画：transform不能同时设置 scale/rotate 和 opacity，需要用两个动画曲线分别处理</li>
<li>居中：设计导出的动画没有考虑小屏机的屏幕尺寸（小于375*812）导致absolute布局不居中，使用多一层div包裹，设置相对定位，宽高100%</li>
<li>动画卡顿：ios上，避免使用step(1)的动画，有卡顿感，而应该改为linear，通过动画曲线设置渐变</li>
<li>字体渲染出现白边：对动画文字格栅化渲染问题，可以通过添加will-change优化相应的文字动画；另外也可以通过加上clip-path: inset(1px); 裁剪解决</li>
<li>iphone非标准底部，需要添加 iphone对应的变量：env(safe-area-inset-bottom) 但在ios9以下不生效，需要确保添加了fallback的值兼容</li>
<li>查文档手册，尽量避免使用grid、gap等可能有兼容性问题的属性</li>
</ul>
</li>
<li>Mixin
<ul>
<li>字体渐变</li>
<li>0.5px的边框</li>
</ul>
</li>
</ul>
</div><hr class="hr-fade-content" data-content="&lt;/ 技术优化小记（Web Vitals、兼容性等） &gt;"/></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"技术优化小记（Web Vitals、兼容性等）","date":"2023-08-27","slug":"improve-web-vitals","content":"\u003ch1\u003e技术优化\u003c/h1\u003e\n\u003cp\u003e主要分为UX、DX两个方面，优化用户体验和开发体验。\u003c/p\u003e\n\u003ch2\u003e保持输入\u003c/h2\u003e\n\u003cp\u003e保持对前端技术的灵敏嗅觉，了解新技术趋势（如swc、fresh、astro、qwik、million、lexical、turbopack、esbuild等新技术），并结合实际场景进行落地。\u003c/p\u003e\n\u003ch2\u003e优化Web Vitals\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e提升FCP（\u003cem\u003e优\u0026#x3C;1.8s\u0026#x3C;差强人意\u0026#x3C;3s\u0026#x3C;差\u003c/em\u003e）：\n\u003cul\u003e\n\u003cli\u003e动态加载组件\u003c/li\u003e\n\u003cli\u003elazy-load/CDN img\u003c/li\u003e\n\u003cli\u003eh2/h3\u003c/li\u003e\n\u003cli\u003e用webpack删代码treeShake+分包splitChunks\u003c/li\u003e\n\u003cli\u003e并行请求\u003c/li\u003e\n\u003cli\u003e文本内容尽早展示（font-display: swap）\u003c/li\u003e\n\u003cli\u003e善用缓存（cache-control/expires/etag/last-modified）\u003c/li\u003e\n\u003cli\u003ebrotli格式压缩（nginx 配置）\u003c/li\u003e\n\u003cli\u003eInline CSS\u003c/li\u003e\n\u003cli\u003eInline Img（base64）\u003c/li\u003e\n\u003cli\u003eCDN加载公共js\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e提升CLS（\u003cem\u003eimpact×distance，优\u0026#x3C;0.1\u0026#x3C;差强人意\u0026#x3C;0.25\u0026#x3C;差\u003c/em\u003e）：\n\u003cul\u003e\n\u003cli\u003e善用亲属关系hint（rel=dns-prefetch/prefetch/preload/preconnect）\u003c/li\u003e\n\u003cli\u003eWebP格式\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e提升FID（\u003cem\u003e优\u0026#x3C;100ms\u0026#x3C;差强人意\u0026#x3C;200ms\u0026#x3C;差\u003c/em\u003e）：\n\u003cul\u003e\n\u003cli\u003e将大的同步操作拆分为小的异步操作\u003c/li\u003e\n\u003cli\u003e使用SSR\u003c/li\u003e\n\u003cli\u003e对耗时请求设置支持中断和超时\u003c/li\u003e\n\u003cli\u003e复杂计算使用 Web Worker\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e优化兼容性\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e成体系的CSS兼容方案\n\u003cul\u003e\n\u003cli\u003e使用css预处理器/后处理器：前者提高代码编写的便捷性，后者可以用autoprefixer完善前缀等\u003c/li\u003e\n\u003cli\u003eanimation动画：transform不能同时设置 scale/rotate 和 opacity，需要用两个动画曲线分别处理\u003c/li\u003e\n\u003cli\u003e居中：设计导出的动画没有考虑小屏机的屏幕尺寸（小于375*812）导致absolute布局不居中，使用多一层div包裹，设置相对定位，宽高100%\u003c/li\u003e\n\u003cli\u003e动画卡顿：ios上，避免使用step(1)的动画，有卡顿感，而应该改为linear，通过动画曲线设置渐变\u003c/li\u003e\n\u003cli\u003e字体渲染出现白边：对动画文字格栅化渲染问题，可以通过添加will-change优化相应的文字动画；另外也可以通过加上clip-path: inset(1px); 裁剪解决\u003c/li\u003e\n\u003cli\u003eiphone非标准底部，需要添加 iphone对应的变量：env(safe-area-inset-bottom) 但在ios9以下不生效，需要确保添加了fallback的值兼容\u003c/li\u003e\n\u003cli\u003e查文档手册，尽量避免使用grid、gap等可能有兼容性问题的属性\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eMixin\n\u003cul\u003e\n\u003cli\u003e字体渐变\u003c/li\u003e\n\u003cli\u003e0.5px的边框\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"improve-web-vitals"},"buildId":"yhe8F9jpnbaXFIeVB9bEE","assetPrefix":"https://fulgari.github.io","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>